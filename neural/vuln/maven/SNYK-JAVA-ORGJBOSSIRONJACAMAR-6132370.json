{
    "CVSSv3": {
        "CVSS": "3.1",
        "attackVector": "NETWORK",
        "attackComplexity": "LOW",
        "privilegesRequired": "NONE",
        "userInteraction": "NONE",
        "scope": "UNCHANGED",
        "confidentiality": "NONE",
        "integrity": "LOW",
        "availability": "NONE"
    },
    "credit": [
        "q5438722"
    ],
    "cvssDetails": [
        {
            "assigner": "NVD",
            "cvssV3BaseScore": 4.3,
            "cvssV3Vector": {
                "CVSS": "3.1",
                "attackVector": "NETWORK",
                "attackComplexity": "LOW",
                "privilegesRequired": "NONE",
                "userInteraction": "REQUIRED",
                "scope": "UNCHANGED",
                "confidentiality": "NONE",
                "integrity": "LOW",
                "availability": "NONE"
            },
            "severity": "medium"
        }
    ],
    "cvssScore": 5.3,
    "disclosureTime": "2022-05-17 05:17:01",
    "epssDetails": {
        "modelVersion": "v2023.03.01",
        "percentile": "0.79308",
        "probability": "0.00778"
    },
    "exploitMaturity": "Not Defined",
    "id": "SNYK-JAVA-ORGJBOSSIRONJACAMAR-6132370",
    "identifiers": {
        "CVE": [
            "CVE-2012-3428"
        ],
        "CWE": [
            "CWE-287"
        ]
    },
    "language": "java",
    "malicious": false,
    "packageManager": "maven",
    "publicationTime": "2023-12-20 14:33:35",
    "remediation": "Upgrade org.jboss.ironjacamar:ironjacamar-jdbc to version 1.0.12.Final or higher. ",
    "severity": "medium",
    "socialTrendAlert": false,
    "title": "Improper Authentication",
    "vulnDescription": {
        "Overview": "Affected versions of this package are vulnerable to Improper Authentication due to improper handling of user credentials when allow-multiple-users is enabled in conjunction with a security domain. An attacker can obtain access to an arbitrary datasource connection by attempting an invalid connection. "
    },
    "source_code": [
        {
            "filename": "deployers/src/main/java/org/jboss/jca/deployers/common/AbstractDsDeployer.java",
            "diff": "@@ -436,13 +436,17 @@ private Object deployDataSource(DataSource ds, String jndiName, String uniqueId,\n       PoolFactory pf = new PoolFactory();\n       PoolStrategy strategy = PoolStrategy.ONE_POOL;\n \n+      boolean allowMultipleUsers = false;\n       if (ds.getPool() != null && ds.getPool() instanceof org.jboss.jca.common.api.metadata.ds.v11.DsPool)\n       {\n          org.jboss.jca.common.api.metadata.ds.v11.DsPool dsPool =\n             (org.jboss.jca.common.api.metadata.ds.v11.DsPool)ds.getPool();\n \n          if (dsPool.isAllowMultipleUsers() != null && dsPool.isAllowMultipleUsers().booleanValue())\n+         {\n             strategy = PoolStrategy.POOL_BY_CRI;\n+            allowMultipleUsers = true;\n+         }\n       }\n \n       // Security\n@@ -456,7 +460,14 @@ private Object deployDataSource(DataSource ds, String jndiName, String uniqueId,\n          }\n          else if (ds.getSecurity().getSecurityDomain() != null)\n          {\n-            strategy = PoolStrategy.POOL_BY_SUBJECT;\n+            if (!allowMultipleUsers)\n+            {\n+               strategy = PoolStrategy.POOL_BY_SUBJECT;\n+            }\n+            else\n+            {\n+               strategy = PoolStrategy.POOL_BY_SUBJECT_AND_CRI;\n+            }\n             securityDomain = ds.getSecurity().getSecurityDomain();\n          }\n       }\n@@ -618,13 +629,17 @@ private Object deployXADataSource(XaDataSource ds, String jndiName, String uniqu\n       PoolFactory pf = new PoolFactory();\n       PoolStrategy strategy = PoolStrategy.ONE_POOL;\n \n+      boolean allowMultipleUsers = false;\n       if (ds.getXaPool() != null && ds.getXaPool() instanceof org.jboss.jca.common.api.metadata.ds.v11.DsXaPool)\n       {\n          org.jboss.jca.common.api.metadata.ds.v11.DsXaPool dsXaPool =\n             (org.jboss.jca.common.api.metadata.ds.v11.DsXaPool)ds.getXaPool();\n \n          if (dsXaPool.isAllowMultipleUsers() != null && dsXaPool.isAllowMultipleUsers().booleanValue())\n+         {\n             strategy = PoolStrategy.POOL_BY_CRI;\n+            allowMultipleUsers = true;\n+         }\n       }\n \n       // Security\n@@ -638,7 +653,14 @@ private Object deployXADataSource(XaDataSource ds, String jndiName, String uniqu\n          }\n          else if (ds.getSecurity().getSecurityDomain() != null)\n          {\n-            strategy = PoolStrategy.POOL_BY_SUBJECT;\n+            if (!allowMultipleUsers)\n+            {\n+               strategy = PoolStrategy.POOL_BY_SUBJECT;\n+            }\n+            else\n+            {\n+               strategy = PoolStrategy.POOL_BY_SUBJECT_AND_CRI;\n+            }\n             securityDomain = ds.getSecurity().getSecurityDomain();\n          }\n       }"
        }
    ],
    "commitTime": "2012-07-24 14:48:01"
}