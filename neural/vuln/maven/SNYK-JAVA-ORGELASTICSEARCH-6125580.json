{
    "CVSSv3": {
        "CVSS": "3.1",
        "attackVector": "ADJACENT_NETWORK",
        "attackComplexity": "LOW",
        "privilegesRequired": "LOW",
        "userInteraction": "REQUIRED",
        "scope": "UNCHANGED",
        "confidentiality": "HIGH",
        "integrity": "NONE",
        "availability": "NONE"
    },
    "credit": [
        "Unknown"
    ],
    "cvssDetails": [
        {
            "assigner": "Red Hat",
            "cvssV3BaseScore": 5.2,
            "cvssV3Vector": {
                "CVSS": "3.1",
                "attackVector": "ADJACENT_NETWORK",
                "attackComplexity": "LOW",
                "privilegesRequired": "LOW",
                "userInteraction": "REQUIRED",
                "scope": "UNCHANGED",
                "confidentiality": "HIGH",
                "integrity": "NONE",
                "availability": "NONE"
            },
            "severity": "medium"
        }
    ],
    "cvssScore": 5.2,
    "disclosureTime": "2023-12-12 00:00:00",
    "epssDetails": null,
    "exploitMaturity": "Not Defined",
    "id": "SNYK-JAVA-ORGELASTICSEARCH-6125580",
    "identifiers": {
        "CVE": [
            "CVE-2023-49921"
        ],
        "CWE": [
            "CWE-779"
        ]
    },
    "language": "java",
    "malicious": false,
    "packageManager": "maven",
    "publicationTime": "2023-12-14 12:49:18",
    "remediation": "Upgrade org.elasticsearch:elasticsearch to version 7.17.16, 8.11.2 or higher. ",
    "severity": "medium",
    "socialTrendAlert": false,
    "title": "Insertion of Sensitive Information into Log File",
    "vulnDescription": {
        "Overview": "org.elasticsearch:elasticsearch is a Distributed, RESTful Search Engine. Affected versions of this package are vulnerable to Insertion of Sensitive Information into Log File due to the logging of Watcher search input at the DEBUG log level, which may result in the unintended recording of sensitive information in log files. An attacker can gain access to sensitive data by examining the log files that contain the search query results. Note: This issue only affects users that use Watcher and have a Watch defined that uses the search input and additionally have set the search input\u2019s logger to DEBUG or finer, for example using: org.elasticsearch.xpack.watcher.input.search org.elasticsearch.xpack.watcher.input org.elasticsearch.xpack.watcher or wider, since the loggers are hierarchical. ",
        "Workaround": "For users that cannot upgrade, if you use Watcher with search input logger set to DEBUG, the logging level can be set to INFO or higher (WARN, ERROR). "
    },
    "source_code": [
        {
            "filename": "x-pack/plugin/watcher/src/main/java/org/elasticsearch/xpack/watcher/input/search/ExecutableSearchInput.java",
            "diff": "@@ -18,7 +18,6 @@\n import org.elasticsearch.common.xcontent.XContentHelper;\n import org.elasticsearch.core.TimeValue;\n import org.elasticsearch.script.Script;\n-import org.elasticsearch.search.SearchHit;\n import org.elasticsearch.xcontent.NamedXContentRegistry;\n import org.elasticsearch.xcontent.XContentParser;\n import org.elasticsearch.xcontent.XContentType;\n@@ -92,9 +91,6 @@ SearchInput.Result doExecute(WatchExecutionContext ctx, WatcherSearchTemplateReq\n \n         if (logger.isDebugEnabled()) {\n             logger.debug(\"[{}] found [{}] hits\", ctx.id(), response.getHits().getTotalHits().value);\n-            for (SearchHit hit : response.getHits()) {\n-                logger.debug(\"[{}] hit [{}]\", ctx.id(), hit.getSourceAsMap());\n-            }\n         }\n \n         final Payload payload;"
        }
    ],
    "commitTime": "2023-11-16 20:47:32"
}